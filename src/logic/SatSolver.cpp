#include "../../include/logic/SatSolver.h"

SatSolver::SatSolver() {
    _solver = kissat_init();
    kissat_set_option (_solver, "quiet", true);
}

/*===========================================================================================================================================================*/
/*===========================================================================================================================================================*/

void SatSolver::add_clause(std::vector<int64_t> &clause) {
    // Add the clause to the CMS solver
    for (auto literal : clause) {
        kissat_add(_solver, literal);
    }
    kissat_add(_solver, 0); // Terminate clause with 0
}

/*===========================================================================================================================================================*/
/*===========================================================================================================================================================*/

void SatSolver::add_clause_short(int64_t lit1, int64_t lit2){
    kissat_add(_solver, lit1);
    
    if (lit2 != 0)
    {
        kissat_add(_solver, lit2);
    }
    
    kissat_add(_solver, 0); // Terminate clause with 0
}

/*===========================================================================================================================================================*/
/*===========================================================================================================================================================*/

std::uint8_t SatSolver::check_var_model(int64_t variable) {
    return kissat_value(_solver, variable) > 0;
}

/*===========================================================================================================================================================*/
/*===========================================================================================================================================================*/

bool SatSolver::solve() {
    // Solve the SAT problem using the CMS solver
    return kissat_solve(_solver) == 10; // Returns true if a solution is found, false otherwise
}